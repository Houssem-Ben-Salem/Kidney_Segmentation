Namespace(root_path='kits19/data', list_dir='./lists_kits19', dataset='KiTS19', num_classes=3, max_iterations=50000, max_epochs=150, batch_size=4, n_gpu=1, deterministic=1, base_lr=0.01, img_size=224, seed=1234, n_skip=3, vit_name='R50-ViT-B_16', vit_patches_size=16, checkpoint_dir='./checkpoints_kits1', use_attention=1, exp='TU_KiTS19_224')
No checkpoint or best model found. Starting training from scratch.
18375 iterations per epoch. 50000 total iterations.
  0%|                                       | 0/50000 [00:00<?, ?it/s]
Iteration 1: Loss 0.9382
Iteration 2: Loss 0.8877
Iteration 3: Loss 0.8064
Iteration 4: Loss 0.7140
Iteration 5: Loss 0.6247
Iteration 6: Loss 0.5507
Iteration 7: Loss 0.5013
Iteration 8: Loss 0.4547
Iteration 9: Loss 0.4095
Iteration 10: Loss 0.4093
Note: NumExpr detected 12 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 8.
  0%|                                       | 0/50000 [00:00<?, ?it/s]/home/hous/anaconda3/envs/torch/lib/python3.10/site-packages/pandas/core/arrays/masked.py:60: UserWarning: Pandas requires version '1.3.6' or newer of 'bottleneck' (version '1.3.5' currently installed).
  from pandas.core import (
Iteration 11: Loss 0.3830
Iteration 12: Loss 0.4241
Iteration 13: Loss 0.3875
Iteration 14: Loss 0.3764
Iteration 15: Loss 0.3482
Iteration 16: Loss 0.3828
Iteration 17: Loss 0.3596
Iteration 18: Loss 0.3553
Iteration 19: Loss 0.3713
Iteration 20: Loss 0.3341
Iteration 21: Loss 0.3483
Iteration 22: Loss 0.3471
Iteration 23: Loss 0.3867
Iteration 24: Loss 0.3520
Iteration 25: Loss 0.3433
Iteration 26: Loss 0.3544
Iteration 27: Loss 0.3493
Iteration 28: Loss 0.3466
Iteration 29: Loss 0.3512
Iteration 30: Loss 0.3315
Iteration 31: Loss 0.3644
Iteration 32: Loss 0.3725
Iteration 33: Loss 0.3567
Iteration 34: Loss 0.3510
Iteration 35: Loss 0.3800
Iteration 36: Loss 0.3483
Iteration 37: Loss 0.3426
Iteration 38: Loss 0.3426
Iteration 39: Loss 0.3865
Iteration 40: Loss 0.3630
Iteration 41: Loss 0.3442
Iteration 42: Loss 0.3546
Iteration 43: Loss 0.3304
Iteration 44: Loss 0.3312
Iteration 45: Loss 0.3488
Iteration 46: Loss 0.3544
Iteration 47: Loss 0.3720
Iteration 48: Loss 0.3491
Iteration 49: Loss 0.3464
Iteration 50: Loss 0.3152
Iteration 51: Loss 0.3343
Iteration 52: Loss 0.3585
Iteration 53: Loss 0.3236
Iteration 54: Loss 0.3554
Iteration 55: Loss 0.3568
Iteration 56: Loss 0.3720
Iteration 57: Loss 0.3402
Iteration 58: Loss 0.3462
Iteration 59: Loss 0.3246
Iteration 60: Loss 0.3459
Iteration 61: Loss 0.3403
Iteration 62: Loss 0.3202
Iteration 63: Loss 0.3630
Iteration 64: Loss 0.3568
Iteration 65: Loss 0.3892
Iteration 66: Loss 0.3443
Iteration 67: Loss 0.3255
Iteration 68: Loss 0.3446
Iteration 69: Loss 0.2948
Iteration 70: Loss 0.3453
Iteration 71: Loss 0.3717
Iteration 72: Loss 0.3175
Iteration 73: Loss 0.3677
Iteration 74: Loss 0.3285
Iteration 75: Loss 0.3230
Iteration 76: Loss 0.3646
Iteration 77: Loss 0.3454
Iteration 78: Loss 0.3310
Iteration 79: Loss 0.2833
Iteration 80: Loss 0.3568
Iteration 81: Loss 0.3258
Iteration 82: Loss 0.2996
Iteration 83: Loss 0.3183
Iteration 84: Loss 0.3085
Iteration 85: Loss 0.2794
Iteration 86: Loss 0.2775
Iteration 87: Loss 0.3404
Iteration 88: Loss 0.3592
Iteration 89: Loss 0.3215
Iteration 90: Loss 0.3212
Iteration 91: Loss 0.2563
Iteration 92: Loss 0.3388
Iteration 93: Loss 0.2785
Iteration 94: Loss 0.4010
Iteration 95: Loss 0.3531
Iteration 96: Loss 0.3577
Iteration 97: Loss 0.3395
Iteration 98: Loss 0.3407
Iteration 99: Loss 0.3382
Iteration 100: Loss 0.3317
Iteration 101: Loss 0.3445
Iteration 102: Loss 0.3002
Iteration 103: Loss 0.3126
Iteration 104: Loss 0.3457
Iteration 105: Loss 0.3344
Iteration 106: Loss 0.3434
Iteration 107: Loss 0.3029
Iteration 108: Loss 0.3036
Iteration 109: Loss 0.3364
Iteration 110: Loss 0.3084
Iteration 111: Loss 0.3432
Iteration 112: Loss 0.3712
Iteration 113: Loss 0.3653
Iteration 114: Loss 0.3120
Iteration 115: Loss 0.3137
Iteration 116: Loss 0.2782
Iteration 117: Loss 0.2879
Iteration 118: Loss 0.3567
Iteration 119: Loss 0.3521
Iteration 120: Loss 0.2915
Iteration 121: Loss 0.3548
Iteration 122: Loss 0.3051
Iteration 123: Loss 0.3341
Iteration 124: Loss 0.3556
Iteration 125: Loss 0.3069
Iteration 126: Loss 0.3420
Iteration 127: Loss 0.3420
Iteration 128: Loss 0.3499
Iteration 129: Loss 0.3426
Iteration 130: Loss 0.3528
Iteration 131: Loss 0.3499
Iteration 132: Loss 0.3416
Iteration 133: Loss 0.3498
Iteration 134: Loss 0.2995
Iteration 135: Loss 0.3083
Iteration 136: Loss 0.3580
Iteration 137: Loss 0.3592
Iteration 138: Loss 0.3261
Iteration 139: Loss 0.3593
Iteration 140: Loss 0.3671
Iteration 141: Loss 0.3560
Iteration 142: Loss 0.3064
Iteration 143: Loss 0.3139
Iteration 144: Loss 0.3126
Iteration 145: Loss 0.3128
Iteration 146: Loss 0.3543
Iteration 147: Loss 0.3026
Iteration 148: Loss 0.3598
Iteration 149: Loss 0.3178
Iteration 150: Loss 0.3575
Iteration 151: Loss 0.3554
Iteration 152: Loss 0.3224
Iteration 153: Loss 0.3197
Iteration 154: Loss 0.3055
Iteration 155: Loss 0.3279
Iteration 156: Loss 0.3138
Iteration 157: Loss 0.3250
Iteration 158: Loss 0.3149
Iteration 159: Loss 0.2858
Iteration 160: Loss 0.3483
Iteration 161: Loss 0.3218
Iteration 162: Loss 0.2814
Iteration 163: Loss 0.2984
Iteration 164: Loss 0.3465
Iteration 165: Loss 0.3323
Iteration 166: Loss 0.3435
Iteration 167: Loss 0.3420
Iteration 168: Loss 0.3400
Iteration 169: Loss 0.3478
Iteration 170: Loss 0.3277
Iteration 171: Loss 0.3153
Iteration 172: Loss 0.3149
Iteration 173: Loss 0.3182
Iteration 174: Loss 0.3556
Iteration 175: Loss 0.3006
Iteration 176: Loss 0.3332
Iteration 177: Loss 0.3314
Iteration 178: Loss 0.3492
Iteration 179: Loss 0.2983
Iteration 180: Loss 0.3502
Iteration 181: Loss 0.3070
Iteration 182: Loss 0.3533
Iteration 183: Loss 0.3509
Iteration 184: Loss 0.2357
Iteration 185: Loss 0.2907
Iteration 186: Loss 0.3488
Iteration 187: Loss 0.2993
Iteration 188: Loss 0.2911
Iteration 189: Loss 0.3430
Iteration 190: Loss 0.3117
Iteration 191: Loss 0.2893
Iteration 192: Loss 0.3365
Iteration 193: Loss 0.2828
Iteration 194: Loss 0.3273
Iteration 195: Loss 0.3425
Iteration 196: Loss 0.3182
Iteration 197: Loss 0.2757
Iteration 198: Loss 0.3558
Iteration 199: Loss 0.2812
Iteration 200: Loss 0.3438
Iteration 201: Loss 0.2679
Iteration 202: Loss 0.3767
Iteration 203: Loss 0.2549
Iteration 204: Loss 0.3276
Iteration 205: Loss 0.3435
Iteration 206: Loss 0.2948
Iteration 207: Loss 0.3091
Iteration 208: Loss 0.3486
Iteration 209: Loss 0.3794
Iteration 210: Loss 0.3028
Iteration 211: Loss 0.2869
Iteration 212: Loss 0.3054
Iteration 213: Loss 0.3356
Iteration 214: Loss 0.3325
Iteration 215: Loss 0.3342
Iteration 216: Loss 0.3198
Iteration 217: Loss 0.2552
Iteration 218: Loss 0.3104
Iteration 219: Loss 0.3137
Iteration 220: Loss 0.3706
Iteration 221: Loss 0.3535
Iteration 222: Loss 0.3086
Iteration 223: Loss 0.3551
Iteration 224: Loss 0.3011
Iteration 225: Loss 0.3366
Iteration 226: Loss 0.3574
Iteration 227: Loss 0.3104
Iteration 228: Loss 0.3380
Iteration 229: Loss 0.3207
Iteration 230: Loss 0.3183
Iteration 231: Loss 0.3577
Iteration 232: Loss 0.3066
Iteration 233: Loss 0.3345
Iteration 234: Loss 0.3374
Iteration 235: Loss 0.3046
Iteration 236: Loss 0.3154
Iteration 237: Loss 0.2997
Iteration 238: Loss 0.3435
Iteration 239: Loss 0.3441
Iteration 240: Loss 0.2940
Iteration 241: Loss 0.2822
Iteration 242: Loss 0.3327
Iteration 243: Loss 0.3357
Iteration 244: Loss 0.2763
Iteration 245: Loss 0.2960
Iteration 246: Loss 0.2948
Iteration 247: Loss 0.3150
Iteration 248: Loss 0.2648
Iteration 249: Loss 0.3545
Iteration 250: Loss 0.3166
Iteration 251: Loss 0.3217
Iteration 252: Loss 0.3221
Iteration 253: Loss 0.3761
Iteration 254: Loss 0.3479
Iteration 255: Loss 0.2922
Iteration 256: Loss 0.2601
Iteration 257: Loss 0.3066
Iteration 258: Loss 0.3496
Iteration 259: Loss 0.3392
Iteration 260: Loss 0.3112
Iteration 261: Loss 0.3334
Iteration 262: Loss 0.3070
Iteration 263: Loss 0.3343
Iteration 264: Loss 0.3277
Iteration 265: Loss 0.3576
Iteration 266: Loss 0.2838
Iteration 267: Loss 0.3330
Iteration 268: Loss 0.3256
Iteration 269: Loss 0.3000
Iteration 270: Loss 0.3258
Iteration 271: Loss 0.3011
Iteration 272: Loss 0.2963
Iteration 273: Loss 0.3072
Iteration 274: Loss 0.2563
Iteration 275: Loss 0.3001
Iteration 276: Loss 0.3189
Iteration 277: Loss 0.2946
Iteration 278: Loss 0.3318
Iteration 279: Loss 0.3430
Iteration 280: Loss 0.3429
Iteration 281: Loss 0.3570
Iteration 282: Loss 0.3283
Iteration 283: Loss 0.3570
Iteration 284: Loss 0.3470
Iteration 285: Loss 0.3474
Iteration 286: Loss 0.2838
Iteration 287: Loss 0.3595
Iteration 288: Loss 0.3380
Iteration 289: Loss 0.3073
Iteration 290: Loss 0.2697
Iteration 291: Loss 0.3600
Iteration 292: Loss 0.3207
Iteration 293: Loss 0.3423
Iteration 294: Loss 0.3510
Iteration 295: Loss 0.3369
Iteration 296: Loss 0.2369
Iteration 297: Loss 0.3474
Iteration 298: Loss 0.3464
Iteration 299: Loss 0.3299
Iteration 300: Loss 0.3415
Iteration 301: Loss 0.2829
Iteration 302: Loss 0.3365
Iteration 303: Loss 0.3180
Iteration 304: Loss 0.3649
Iteration 305: Loss 0.3146
Iteration 306: Loss 0.3275
Iteration 307: Loss 0.2675
Iteration 308: Loss 0.2998
Iteration 309: Loss 0.3031
Iteration 310: Loss 0.3374
Iteration 311: Loss 0.2799
Iteration 312: Loss 0.2826
Iteration 313: Loss 0.2915
Iteration 314: Loss 0.2915
Iteration 315: Loss 0.3138
Iteration 316: Loss 0.2823
Iteration 317: Loss 0.3291
Iteration 318: Loss 0.3201
Iteration 319: Loss 0.2843
Iteration 320: Loss 0.3285
Iteration 321: Loss 0.2927
Iteration 322: Loss 0.3252
Iteration 323: Loss 0.2808
Iteration 324: Loss 0.2712
Iteration 325: Loss 0.3095
Iteration 326: Loss 0.3263
Iteration 327: Loss 0.3409
Iteration 328: Loss 0.3436
Iteration 329: Loss 0.2176
Iteration 330: Loss 0.2937
Iteration 331: Loss 0.3360
Iteration 332: Loss 0.3512
Iteration 333: Loss 0.3431
Iteration 334: Loss 0.3498
Iteration 335: Loss 0.3745
Iteration 336: Loss 0.3236
Iteration 337: Loss 0.3475
Iteration 338: Loss 0.3216
Iteration 339: Loss 0.3125
Iteration 340: Loss 0.3063
Iteration 341: Loss 0.3179
Iteration 342: Loss 0.2682
Iteration 343: Loss 0.3428
Iteration 344: Loss 0.3122
Iteration 345: Loss 0.3502
Iteration 346: Loss 0.3490
Iteration 347: Loss 0.3015
Iteration 348: Loss 0.3471
Iteration 349: Loss 0.2762
Iteration 350: Loss 0.2898
Iteration 351: Loss 0.3458
Iteration 352: Loss 0.3229
Iteration 353: Loss 0.2648
Iteration 354: Loss 0.2737
Iteration 355: Loss 0.2823
Iteration 356: Loss 0.3258
Iteration 357: Loss 0.3319
Iteration 358: Loss 0.2642
Iteration 359: Loss 0.3017
Iteration 360: Loss 0.3532
Iteration 361: Loss 0.2595
Iteration 362: Loss 0.3238
Iteration 363: Loss 0.3071
Iteration 364: Loss 0.3142
Iteration 365: Loss 0.2843
Iteration 366: Loss 0.3560
Iteration 367: Loss 0.3561
Iteration 368: Loss 0.3350
Iteration 369: Loss 0.2967
Iteration 370: Loss 0.2784
Iteration 371: Loss 0.3706
Exception in thread Thread-4 (_pin_memory_loop):
Traceback (most recent call last):
  File "/home/hous/anaconda3/envs/torch/lib/python3.10/threading.py", line 1016, in _bootstrap_inner
    self.run()
  File "/home/hous/anaconda3/envs/torch/lib/python3.10/threading.py", line 953, in run
    self._target(*self._args, **self._kwargs)
  File "/home/hous/anaconda3/envs/torch/lib/python3.10/site-packages/torch/utils/data/_utils/pin_memory.py", line 54, in _pin_memory_loop
    do_one_step()
  File "/home/hous/anaconda3/envs/torch/lib/python3.10/site-packages/torch/utils/data/_utils/pin_memory.py", line 31, in do_one_step
    r = in_queue.get(timeout=MP_STATUS_CHECK_INTERVAL)
  File "/home/hous/anaconda3/envs/torch/lib/python3.10/multiprocessing/queues.py", line 122, in get
    return _ForkingPickler.loads(res)
  File "/home/hous/anaconda3/envs/torch/lib/python3.10/site-packages/torch/multiprocessing/reductions.py", line 355, in rebuild_storage_fd
    fd = df.detach()
  File "/home/hous/anaconda3/envs/torch/lib/python3.10/multiprocessing/resource_sharer.py", line 57, in detach
    with _resource_sharer.get_connection(self._id) as conn:
  File "/home/hous/anaconda3/envs/torch/lib/python3.10/multiprocessing/resource_sharer.py", line 86, in get_connection
    c = Client(address, authkey=process.current_process().authkey)
  File "/home/hous/anaconda3/envs/torch/lib/python3.10/multiprocessing/connection.py", line 502, in Client
    c = SocketClient(address)
  File "/home/hous/anaconda3/envs/torch/lib/python3.10/multiprocessing/connection.py", line 630, in SocketClient
    s.connect(address)
FileNotFoundError: [Errno 2] No such file or directory
  0%|                                       | 0/50000 [14:40<?, ?it/s]
Traceback (most recent call last):
  File "/home/hous/Desktop/Kidney_Segmentation/TransUNet/train.py", line 86, in <module>
    trainer_kits19(args, net)
  File "/home/hous/Desktop/Kidney_Segmentation/TransUNet/trainer.py", line 142, in trainer_kits19
    loss.backward()
  File "/home/hous/anaconda3/envs/torch/lib/python3.10/site-packages/torch/_tensor.py", line 492, in backward
    torch.autograd.backward(
  File "/home/hous/anaconda3/envs/torch/lib/python3.10/site-packages/torch/autograd/__init__.py", line 251, in backward
    Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
KeyboardInterrupt