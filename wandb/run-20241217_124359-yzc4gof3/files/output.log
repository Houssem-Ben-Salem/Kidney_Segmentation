Namespace(root_path='kits19/data', list_dir='./lists_kits19', dataset='KiTS19', num_classes=3, max_iterations=50000, max_epochs=150, batch_size=1, n_gpu=1, deterministic=1, base_lr=0.01, img_size=224, seed=1234, n_skip=3, vit_name='R50-ViT-B_16', vit_patches_size=16, exp='TU_KiTS19_224')
No checkpoint or best model found. Starting training from scratch.
73500 iterations per epoch. 50000 total iterations.
  0%|                                       | 0/50000 [00:00<?, ?it/s]
Iteration 1: Loss 0.9399
Iteration 2: Loss 0.8905
Iteration 3: Loss 0.8144
Iteration 4: Loss 0.7199
Iteration 5: Loss 0.6275
Iteration 6: Loss 0.5636
Iteration 7: Loss 0.5002
Iteration 8: Loss 0.4524
Iteration 9: Loss 0.4212
Iteration 10: Loss 0.4018
Iteration 11: Loss 0.4413
Iteration 12: Loss 0.3706
Iteration 13: Loss 0.3901
Iteration 14: Loss 0.3564
Iteration 15: Loss 0.4259
Iteration 16: Loss 0.3607
Iteration 17: Loss 0.3455
Iteration 18: Loss 0.3441
Iteration 19: Loss 0.3732
Iteration 20: Loss 0.4122
Iteration 21: Loss 0.4024
Iteration 22: Loss 0.3812
Iteration 23: Loss 0.4026
Iteration 24: Loss 0.3412
Iteration 25: Loss 0.3411
Iteration 26: Loss 0.3409
Iteration 27: Loss 0.3403
Iteration 28: Loss 0.3404
Iteration 29: Loss 0.3389
Iteration 30: Loss 0.3384
Iteration 31: Loss 0.3385
Iteration 32: Loss 0.3379
Iteration 33: Loss 0.3865
Iteration 34: Loss 0.3373
Iteration 35: Loss 0.5490
Iteration 36: Loss 0.3366
Iteration 37: Loss 0.3366
Iteration 38: Loss 0.3366
Iteration 39: Loss 0.3982
Iteration 40: Loss 0.4408
Iteration 41: Loss 0.3365
Iteration 42: Loss 0.3370
Iteration 43: Loss 0.3365
Iteration 44: Loss 0.3379
Iteration 45: Loss 0.4808
Iteration 46: Loss 0.5424
Iteration 47: Loss 0.3819
Iteration 48: Loss 0.3388
Iteration 49: Loss 0.3400
Iteration 50: Loss 0.3410
Iteration 51: Loss 0.3573
Iteration 52: Loss 0.4906
Iteration 53: Loss 0.3802
Iteration 54: Loss 0.3840
Iteration 55: Loss 0.3450
Iteration 56: Loss 0.3479
Iteration 57: Loss 0.3661
Iteration 58: Loss 0.3554
Iteration 59: Loss 0.3506
Iteration 60: Loss 0.3509
Iteration 61: Loss 0.4456
Iteration 62: Loss 0.3478
Iteration 63: Loss 0.3579
Iteration 64: Loss 0.3489
Iteration 65: Loss 0.3455
Iteration 66: Loss 0.4224
Iteration 67: Loss 0.3440
Iteration 68: Loss 0.3436
Iteration 69: Loss 0.3431
Iteration 70: Loss 0.3529
Iteration 71: Loss 0.3390
Iteration 72: Loss 0.4061
Iteration 73: Loss 0.4158
Iteration 74: Loss 0.3884
Iteration 75: Loss 0.3516
Iteration 76: Loss 0.3520
Iteration 77: Loss 0.3576
Iteration 78: Loss 0.3549
Iteration 79: Loss 0.3488
Iteration 80: Loss 0.3501
Iteration 81: Loss 0.3533
Iteration 82: Loss 0.3497
Iteration 83: Loss 0.3474
Iteration 84: Loss 0.3438
Iteration 85: Loss 0.3416
Iteration 86: Loss 0.3416
Iteration 87: Loss 0.3390
Iteration 88: Loss 0.3381
Iteration 89: Loss 0.4663
Iteration 90: Loss 0.3368
Iteration 91: Loss 0.4386
Iteration 92: Loss 0.3361
Iteration 93: Loss 0.3365
Iteration 94: Loss 0.3372
Iteration 95: Loss 0.3537
Iteration 96: Loss 0.3750
Iteration 97: Loss 0.3375
Iteration 98: Loss 0.3501
Iteration 99: Loss 0.3390
Iteration 100: Loss 0.3378
Iteration 101: Loss 0.4115
Iteration 102: Loss 0.3387
Iteration 103: Loss 0.3909
Iteration 104: Loss 0.3398
Iteration 105: Loss 0.3411
Iteration 106: Loss 0.3343
Iteration 107: Loss 0.3411
Iteration 108: Loss 0.3417
Iteration 109: Loss 0.3435
Iteration 110: Loss 0.3427
Iteration 111: Loss 0.3406
Iteration 112: Loss 0.3394
Iteration 113: Loss 0.3317
Iteration 114: Loss 0.4062
Iteration 115: Loss 0.3506
Iteration 116: Loss 0.3395
Iteration 117: Loss 0.3424
Iteration 118: Loss 0.3406
Iteration 119: Loss 0.3409
Iteration 120: Loss 0.3318
Iteration 121: Loss 0.3426
Iteration 122: Loss 0.3663
Iteration 123: Loss 0.3723
Iteration 124: Loss 0.3408
Iteration 125: Loss 0.3402
Iteration 126: Loss 0.3400
Iteration 127: Loss 0.3406
Iteration 128: Loss 0.3705
Iteration 129: Loss 0.3555
Iteration 130: Loss 0.3461
Iteration 131: Loss 0.3500
Iteration 132: Loss 0.3488
Iteration 133: Loss 0.3463
Iteration 134: Loss 0.3540
Iteration 135: Loss 0.3872
Iteration 136: Loss 0.3491
Iteration 137: Loss 0.4108
Iteration 138: Loss 0.3620
Iteration 139: Loss 0.3511
Iteration 140: Loss 0.3371
Iteration 141: Loss 0.3568
Iteration 142: Loss 0.3527
Iteration 143: Loss 0.3431
Iteration 144: Loss 0.3279
Iteration 145: Loss 0.3502
Iteration 146: Loss 0.3756
Iteration 147: Loss 0.3471
Iteration 148: Loss 0.3300
Iteration 149: Loss 0.3443
Iteration 150: Loss 0.3432
Iteration 151: Loss 0.3427
Iteration 152: Loss 0.3429
Iteration 153: Loss 0.3439
Iteration 154: Loss 0.4943
Iteration 155: Loss 0.3443
Iteration 156: Loss 0.3494
Iteration 157: Loss 0.3516
Iteration 158: Loss 0.3497
Iteration 159: Loss 0.3504
Iteration 160: Loss 0.4546
Iteration 161: Loss 0.3512
Iteration 162: Loss 0.3414
Iteration 163: Loss 0.3537
Iteration 164: Loss 0.3381
Iteration 165: Loss 0.3543
Iteration 166: Loss 0.3539
Iteration 167: Loss 0.3515
Iteration 168: Loss 0.3490
Iteration 169: Loss 0.3498
Iteration 170: Loss 0.3458
Iteration 171: Loss 0.3444
Iteration 172: Loss 0.3422
Iteration 173: Loss 0.3306
Iteration 174: Loss 0.3419
Iteration 175: Loss 0.3475
Iteration 176: Loss 0.3418
Iteration 177: Loss 0.3410
Iteration 178: Loss 0.4109
Iteration 179: Loss 0.3453
Iteration 180: Loss 0.3749
Iteration 181: Loss 0.3474
Iteration 182: Loss 0.3250
Iteration 183: Loss 0.3276
Iteration 184: Loss 0.3442
Iteration 185: Loss 0.3330
Iteration 186: Loss 0.3474
Iteration 187: Loss 0.4041
Iteration 188: Loss 0.3552
Iteration 189: Loss 0.3523
Iteration 190: Loss 0.3556
Iteration 191: Loss 0.3549
Iteration 192: Loss 0.3507
Iteration 193: Loss 0.3636
Iteration 194: Loss 0.3413
Iteration 195: Loss 0.3908
Iteration 196: Loss 0.3475
Iteration 197: Loss 0.3470
Iteration 198: Loss 0.3412
Iteration 199: Loss 0.3463
Iteration 200: Loss 0.3819
Iteration 201: Loss 0.4028
Iteration 202: Loss 0.4130
Iteration 203: Loss 0.3489
Iteration 204: Loss 0.3476
Iteration 205: Loss 0.3495
Iteration 206: Loss 0.3485
Iteration 207: Loss 0.3462
Iteration 208: Loss 0.3479
Iteration 209: Loss 0.3679
Iteration 210: Loss 0.3428
Iteration 211: Loss 0.3413
Iteration 212: Loss 0.4302
Iteration 213: Loss 0.3423
Iteration 214: Loss 0.3395
Iteration 215: Loss 0.3435
Iteration 216: Loss 0.3414
Iteration 217: Loss 0.3425
Iteration 218: Loss 0.4605
Iteration 219: Loss 0.3413
Iteration 220: Loss 0.3412
Iteration 221: Loss 0.3405
Iteration 222: Loss 0.3720
Iteration 223: Loss 0.3410
Iteration 224: Loss 0.3431
Iteration 225: Loss 0.3455
Iteration 226: Loss 0.3110
Iteration 227: Loss 0.3510
Iteration 228: Loss 0.3528
Iteration 229: Loss 0.3525
Iteration 230: Loss 0.3525
Iteration 231: Loss 0.3542
Iteration 232: Loss 0.3123
Iteration 233: Loss 0.3474
Iteration 234: Loss 0.2867
Iteration 235: Loss 0.3487
Iteration 236: Loss 0.3456
Iteration 237: Loss 0.3454
Iteration 238: Loss 0.3140
Iteration 239: Loss 0.3400
Iteration 240: Loss 0.3410
Iteration 241: Loss 0.3380
Iteration 242: Loss 0.3364
Iteration 243: Loss 0.3560
Iteration 244: Loss 0.3369
Iteration 245: Loss 0.3421
Iteration 246: Loss 0.3369
Iteration 247: Loss 0.3398
Iteration 248: Loss 0.3421
Iteration 249: Loss 0.3858
Iteration 250: Loss 0.3399
Iteration 251: Loss 0.3485
Iteration 252: Loss 0.3471
Iteration 253: Loss 0.3722
Iteration 254: Loss 0.3519
Iteration 255: Loss 0.3476
Iteration 256: Loss 0.3110
Iteration 257: Loss 0.3469
Iteration 258: Loss 0.3853
Iteration 259: Loss 0.3041
Iteration 260: Loss 0.3401
Iteration 261: Loss 0.3576
Iteration 262: Loss 0.3535
Iteration 263: Loss 0.3589
Iteration 264: Loss 0.3584
Iteration 265: Loss 0.3214
Iteration 266: Loss 0.3453
Iteration 267: Loss 0.3473
Iteration 268: Loss 0.3624
Iteration 269: Loss 0.3563
Iteration 270: Loss 0.3522
Iteration 271: Loss 0.3515
Iteration 272: Loss 0.3522
Iteration 273: Loss 0.3210
Iteration 274: Loss 0.3491
Iteration 275: Loss 0.3088
Iteration 276: Loss 0.3486
Iteration 277: Loss 0.4910
Iteration 278: Loss 0.3100
Iteration 279: Loss 0.3516
Iteration 280: Loss 0.3614
Iteration 281: Loss 0.3542
Iteration 282: Loss 0.3491
Iteration 283: Loss 0.3543
Iteration 284: Loss 0.3558
Iteration 285: Loss 0.3490
Iteration 286: Loss 0.3512
Iteration 287: Loss 0.3058
Iteration 288: Loss 0.3504
Iteration 289: Loss 0.3538
Iteration 290: Loss 0.3454
Iteration 291: Loss 0.3456
Iteration 292: Loss 0.3439
Iteration 293: Loss 0.6112
Iteration 294: Loss 0.3439
Iteration 295: Loss 0.3444
Iteration 296: Loss 0.3238
Iteration 297: Loss 0.3410
Iteration 298: Loss 0.3427
Iteration 299: Loss 0.3396
Iteration 300: Loss 0.4343
Iteration 301: Loss 0.3436
Iteration 302: Loss 0.3401
Iteration 303: Loss 0.3463
Iteration 304: Loss 0.3456
Iteration 305: Loss 0.3428
Iteration 306: Loss 0.3641
Iteration 307: Loss 0.4017
Iteration 308: Loss 0.3434
Iteration 309: Loss 0.3479
Iteration 310: Loss 0.3392
Iteration 311: Loss 0.3235
Iteration 312: Loss 0.3131
Iteration 313: Loss 0.3505
Iteration 314: Loss 0.3672
Iteration 315: Loss 0.3538
Iteration 316: Loss 0.3361
Iteration 317: Loss 0.3658
Iteration 318: Loss 0.3701
Iteration 319: Loss 0.3694
Iteration 320: Loss 0.3763
Iteration 321: Loss 0.3578
Iteration 322: Loss 0.3614
Iteration 323: Loss 0.3591
Iteration 324: Loss 0.3142
Iteration 325: Loss 0.2946
Iteration 326: Loss 0.3497
Iteration 327: Loss 0.3647
Iteration 328: Loss 0.3208
Iteration 329: Loss 0.3496
Iteration 330: Loss 0.3494
Iteration 331: Loss 0.2993
Iteration 332: Loss 0.3446
Iteration 333: Loss 0.3447
Iteration 334: Loss 0.3357
Iteration 335: Loss 0.3265
Iteration 336: Loss 0.3406
Iteration 337: Loss 0.2953
Iteration 338: Loss 0.3404
Iteration 339: Loss 0.3598
Iteration 340: Loss 0.4061
Iteration 341: Loss 0.3544
Iteration 342: Loss 0.3455
Iteration 343: Loss 0.3525
Iteration 344: Loss 0.3230
Iteration 345: Loss 0.3016
Iteration 346: Loss 0.3111
Iteration 347: Loss 0.3429
Iteration 348: Loss 0.3218
Iteration 349: Loss 0.5073
Iteration 350: Loss 0.3438
Iteration 351: Loss 0.3781
Iteration 352: Loss 0.3770
Iteration 353: Loss 0.3741
Iteration 354: Loss 0.3285
Iteration 355: Loss 0.3665
Iteration 356: Loss 0.3458
Iteration 357: Loss 0.3560
Iteration 358: Loss 0.3510
Iteration 359: Loss 0.3470
Iteration 360: Loss 0.3710
Iteration 361: Loss 0.3428
Iteration 362: Loss 0.3424
Iteration 363: Loss 0.3912
Iteration 364: Loss 0.3397
Iteration 365: Loss 0.3403
Iteration 366: Loss 0.3381
Iteration 367: Loss 0.3364
Iteration 368: Loss 0.3380
Iteration 369: Loss 0.3377
Iteration 370: Loss 0.3529
Iteration 371: Loss 0.3372
Iteration 372: Loss 0.3372
Iteration 373: Loss 0.3812
Iteration 374: Loss 0.5276
Iteration 375: Loss 0.3374
Iteration 376: Loss 0.3379
Iteration 377: Loss 0.3374
Iteration 378: Loss 0.3382
Iteration 379: Loss 0.3766
Iteration 380: Loss 0.3941
Iteration 381: Loss 0.3847
Iteration 382: Loss 0.3372
Iteration 383: Loss 0.3245
Iteration 384: Loss 0.3527
Iteration 385: Loss 0.3575
Iteration 386: Loss 0.3504
Iteration 387: Loss 0.3511
Iteration 388: Loss 0.3548
Iteration 389: Loss 0.3461
Iteration 390: Loss 0.3518
Iteration 391: Loss 0.3715
Iteration 392: Loss 0.3442
Iteration 393: Loss 0.3448
Iteration 394: Loss 0.3457
Iteration 395: Loss 0.3413
Iteration 396: Loss 0.3415
Iteration 397: Loss 0.3400
Iteration 398: Loss 0.3390
Iteration 399: Loss 0.3392
Iteration 400: Loss 0.3460
Iteration 401: Loss 0.3379
Iteration 402: Loss 0.3372
Iteration 403: Loss 0.3370
Iteration 404: Loss 0.3368
Iteration 405: Loss 0.3363
Iteration 406: Loss 0.3361
Iteration 407: Loss 0.3596
Iteration 408: Loss 0.4370
Iteration 409: Loss 0.3360
Iteration 410: Loss 0.3358
Iteration 411: Loss 0.3359
Iteration 412: Loss 0.5443
Iteration 413: Loss 0.5356
Iteration 414: Loss 0.3696
Iteration 415: Loss 0.3373
Iteration 416: Loss 0.3400
Iteration 417: Loss 0.3391
Iteration 418: Loss 0.4608
Iteration 419: Loss 0.3484
Iteration 420: Loss 0.3522
Iteration 421: Loss 0.3294
Iteration 422: Loss 0.3532
Iteration 423: Loss 0.3267
Iteration 424: Loss 0.3567
Iteration 425: Loss 0.3322
Iteration 426: Loss 0.3365
Iteration 427: Loss 0.3525
Iteration 428: Loss 0.3367
Iteration 429: Loss 0.3508
Iteration 430: Loss 0.2987
Iteration 431: Loss 0.3489
Iteration 432: Loss 0.3610
Iteration 433: Loss 0.3552
Iteration 434: Loss 0.3584
Iteration 435: Loss 0.3025
Iteration 436: Loss 0.3566
Iteration 437: Loss 0.3528
Iteration 438: Loss 0.3497
Iteration 439: Loss 0.3262
Iteration 440: Loss 0.3368
Iteration 441: Loss 0.3444
Iteration 442: Loss 0.3426
Iteration 443: Loss 0.3424
Iteration 444: Loss 0.3145
Iteration 445: Loss 0.3411
Iteration 446: Loss 0.3412
Iteration 447: Loss 0.3396
Iteration 448: Loss 0.3393
Iteration 449: Loss 0.3384
Iteration 450: Loss 0.3395
Iteration 451: Loss 0.3381
Iteration 452: Loss 0.3369
Iteration 453: Loss 0.3366
Iteration 454: Loss 0.3442
Iteration 455: Loss 0.4288
Iteration 456: Loss 0.3371
Iteration 457: Loss 0.3632
Iteration 458: Loss 0.3622
Iteration 459: Loss 0.3451
Iteration 460: Loss 0.3416
Iteration 461: Loss 0.3692
Iteration 462: Loss 0.3486
Iteration 463: Loss 0.3018
Iteration 464: Loss 0.3591
Iteration 465: Loss 0.3165
Iteration 466: Loss 0.3675
Iteration 467: Loss 0.3148
Iteration 468: Loss 0.3645
Iteration 469: Loss 0.3625
Iteration 470: Loss 0.3503
Iteration 471: Loss 0.3540
Iteration 472: Loss 0.3153
Iteration 473: Loss 0.3609
Iteration 474: Loss 0.3587
Iteration 475: Loss 0.3517
Iteration 476: Loss 0.3469
Iteration 477: Loss 0.3336
Iteration 478: Loss 0.3459
Iteration 479: Loss 0.3430
Iteration 480: Loss 0.3433
Iteration 481: Loss 0.3423
Iteration 482: Loss 0.3401
Iteration 483: Loss 0.3457
Iteration 484: Loss 0.3481
Iteration 485: Loss 0.3706
Iteration 486: Loss 0.4004
Iteration 487: Loss 0.3417
Iteration 488: Loss 0.3413
Iteration 489: Loss 0.3417
Iteration 490: Loss 0.3301
Iteration 491: Loss 0.3441
Iteration 492: Loss 0.3547
Iteration 493: Loss 0.3888
Iteration 494: Loss 0.3225
Iteration 495: Loss 0.3027
Iteration 496: Loss 0.3652
Iteration 497: Loss 0.3664
Iteration 498: Loss 0.3050
Iteration 499: Loss 0.3683
  0%|                                       | 0/50000 [15:38<?, ?it/s]
Traceback (most recent call last):
  File "/home/hous/Desktop/Kidney_Segmentation/TransUNet/train.py", line 85, in <module>
    trainer_kits19(args, net, snapshot_path)
  File "/home/hous/Desktop/Kidney_Segmentation/TransUNet/trainer.py", line 142, in trainer_kits19
  File "/home/hous/Desktop/Kidney_Segmentation/TransUNet/trainer.py", line 30, in validate
    loss_dice = dice_loss(outputs, label_batch, softmax=True)
  File "/home/hous/anaconda3/envs/torch/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/hous/anaconda3/envs/torch/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/hous/Desktop/Kidney_Segmentation/TransUNet/utils.py", line 43, in forward
    class_wise_dice.append(1.0 - dice.item())
KeyboardInterrupt